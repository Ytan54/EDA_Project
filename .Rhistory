install.packages(ggplot2)
install.packages(car)
install.packages(carData)
install.packages(ResourceSelection)
install.packages(pROC)
install.packages(dyplr)
install.packages(ggplot2)
install.packages(car)
install.packages(carData)
install.packages(ResourceSelection)
install.packages(pROC)
install.packages(dyplr)
install.packages(ggplot2)
install.packages(car)
install.packages(carData)
install.packages(ResourceSelection)
install.packages(pROC)
install.packages(dyplr)
install.packages(ggplot2)
install.packages(car)
install.packages(carData)
install.packages(ResourceSelection)
install.packages(pROC)
install.packages(dyplr)
install.packages(ggplot2)
install.packages(car)
install.packages(carData)
install.packages(ResourceSelection)
install.packages(pROC)
install.packages(dyplr)
install.packages(ggplot2)
install.packages(car)
install.packages(carData)
install.packages(ResourceSelection)
install.packages(pROC)
install.packages(dyplr)
install.packages("ggplot2")
install.packages("car")
install.packages("carData")
install.packages("ResourceSelection")
install.packages("pROC")
install.packages("dplyr")
# Load libraries
library(ggplot2)
library(car)
library(carData)
library(ResourceSelection)
library(pROC)
library(dplyr)
# Load libraries
library(ggplot2)
library(car)
library(carData)
library(ResourceSelection)
library(pROC)
library(dplyr)
library(emmeans)
library(ggeffects)
df_clean <- read.csv("~/Documents/GitHub/EDA_Project/data/cleaned_data.csv")
# Function to calculate mode
get_mode <- function(v) {
tbl <- table(v)
mode_val <- names(tbl)[which.max(tbl)]
return(mode_val)
}
#Table
prop.table(table(df_clean$HeartAttack, df_clean$BMI_Cat), margin = 2)
ggplot(df_clean, aes(x = BMI_Level, fill = HeartAttack)) +
geom_bar(position = "fill") +
ylab("Proportion") +
xlab("BMI Level") +
labs(fill = "Heart Attack Status") +
scale_x_discrete(labels = c(
"Underweight" = "Underweight (< 18.5)",
"Normal"      = "Normal Weight (18.5–24.9)",
"Overweight"  = "Overweight (25.0–29.9)",
"Obese"       = "Obese (≥ 30.0)"
))
View(df_clean)
#Table
prop.table(table(df_clean$HeartAttack, df_clean$BMI_Cat), margin = 2)
ggplot(df_clean, aes(x = BMI_Cat, fill = HeartAttack)) +
geom_bar(position = "fill") +
ylab("Proportion") +
xlab("BMI Level") +
labs(fill = "Heart Attack Status") +
scale_x_discrete(labels = c(
"Underweight" = "Underweight (< 18.5)",
"Normal"      = "Normal Weight (18.5–24.9)",
"Overweight"  = "Overweight (25.0–29.9)",
"Obese"       = "Obese (≥ 30.0)"
))
custom_colors <- c("No" = "#1a80bb", "Yes" = "#f2c45f")
#Table
prop.table(table(df_clean$HeartAttack, df_clean$BMI_Cat), margin = 2)
ggplot(df_clean, aes(x = BMI_Cat, fill = HeartAttack)) +
geom_bar(position = "fill") +
ylab("Proportion") +
xlab("BMI Level") +
labs(fill = "Heart Attack Status") +
scale_x_discrete(labels = c(
"Underweight" = "Underweight (< 18.5)",
"Normal"      = "Normal Weight (18.5–24.9)",
"Overweight"  = "Overweight (25.0–29.9)",
"Obese"       = "Obese (≥ 30.0)"
)+
scale_fill_manual(values = custom_colors))
custom_colors <- c("No" = "#1a80bb", "Yes" = "#f2c45f")
#Table
prop.table(table(df_clean$HeartAttack, df_clean$BMI_Cat), margin = 2)
ggplot(df_clean, aes(x = BMI_Cat, fill = HeartAttack)) +
geom_bar(position = "fill") +
ylab("Proportion") +
xlab("BMI Level") +
labs(fill = "Heart Attack Status") +
scale_x_discrete(labels = c(
"Underweight" = "Underweight (< 18.5)",
"Normal"      = "Normal Weight (18.5–24.9)",
"Overweight"  = "Overweight (25.0–29.9)",
"Obese"       = "Obese (≥ 30.0)") +
scale_fill_manual(values = custom_colors))
#Table
prop.table(table(df_clean$HeartAttack, df_clean$BMI_Cat), margin = 2)
ggplot(df_clean, aes(x = BMI_Cat, fill = HeartAttack)) +
geom_bar(position = "fill") +
ylab("Proportion") +
xlab("BMI Level") +
labs(fill = "Heart Attack Status") +
scale_x_discrete(labels = c(
"Underweight" = "Underweight (< 18.5)",
"Normal"      = "Normal Weight (18.5–24.9)",
"Overweight"  = "Overweight (25.0–29.9)",
"Obese"       = "Obese (≥ 30.0)") +
scale_fill_manual(values = custom_colors))
#Table
prop.table(table(df_clean$HeartAttack, df_clean$BMI_Cat), margin = 2)
ggplot(df_clean, aes(x = BMI_Cat, fill = HeartAttack)) +
geom_bar(position = "fill") +
ylab("Proportion") +
xlab("BMI Level") +
labs(fill = "Heart Attack Status") +
scale_x_discrete(labels = c(
"Underweight" = "Underweight (< 18.5)",
"Normal"      = "Normal Weight (18.5–24.9)",
"Overweight"  = "Overweight (25.0–29.9)",
"Obese"       = "Obese (≥ 30.0)"
)) +
scale_fill_manual(values = custom_colors)
#Table
prop.table(table(df_clean$HeartAttack, df_clean$BMI_Cat), margin = 2)
ggplot(df_clean, aes(x = BMI_Cat, fill = HeartAttack)) +
geom_bar(position = "fill") +
ylab("Proportion") +
xlab("BMI Level") +
labs(fill = "Heart Attack Status") +
scale_x_discrete(
limits = c("Underweight", "Normal", "Obese", "Overweight"),
labels = c(
"Underweight" = "Underweight (< 18.5)",
"Normal"      = "Normal Weight (18.5–24.9)",
"Obese"       = "Obese (≥ 30.0)",
"Overweight"  = "Overweight (25.0–29.9)"
)
) +
scale_fill_manual(values = custom_colors)
#Table
prop.table(table(df_clean$HeartAttack, df_clean$BMI_Cat), margin = 2)
ggplot(df_clean, aes(x = BMI_Cat, fill = HeartAttack)) +
geom_bar(position = "fill") +
ylab("Proportion") +
xlab("BMI Level") +
labs(fill = "Heart Attack Status") +
scale_x_discrete(
limits = c("Underweight", "Normal", "Obese", "Overweight"),
labels = c(
"Underweight" = "Underweight (< 18.5)",
"Normal"      = "Normal Weight (18.5–24.9)",
"Obese"       = "Obese (≥ 30.0)",
"Overweight"  = "Overweight (25.0–29.9)"
)
) +
scale_fill_manual(values = custom_colors) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
#Table
prop.table(table(df_clean$HeartAttack, df_clean$BMI_Cat), margin = 2)
ggplot(df_clean, aes(x = BMI_Cat, fill = HeartAttack)) +
geom_bar(position = "fill") +
ylab("Proportion") +
xlab("BMI Level") +
labs(fill = "Heart Attack Status") +
scale_x_discrete(
limits = c("Underweight", "Normal", "Obese", "Overweight"),
labels = c(
"Underweight" = "Underweight (< 18.5)",
"Normal"      = "Normal Weight (18.5–24.9)",
"Overweight"  = "Overweight (25.0–29.9)",
"Obese"       = "Obese (≥ 30.0)"
)
) +
scale_fill_manual(values = custom_colors) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
#Table
prop.table(table(df_clean$HeartAttack, df_clean$BMI_Cat), margin = 2)
ggplot(df_clean, aes(x = BMI_Cat, fill = HeartAttack)) +
geom_bar(position = "fill") +
ylab("Proportion") +
xlab("BMI Level") +
labs(fill = "Heart Attack Status") +
scale_x_discrete(
limits = c("Underweight", "Normal", "Overweight", "Obese"),
labels = c(
"Underweight" = "Underweight (< 18.5)",
"Normal"      = "Normal Weight (18.5–24.9)",
"Overweight"  = "Overweight (25.0–29.9)",
"Obese"       = "Obese (≥ 30.0)"
)
) +
scale_fill_manual(values = custom_colors) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
#Table
prop.table(table(df_clean$HeartAttack, df_clean$AGE), margin = 2)
#Bar graph
ggplot(df_clean, aes(x = AGE, fill = HeartAttack)) +
geom_bar(position = "fill") +
ylab("Proportion") +
xlab("Age") +
labs(fill = "Heart Attack Status") +
ggtitle("Proportion of Heart Attack by Age") +
scale_fill_manual(values = custom_colors) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
#Table
prop.table(table(df_clean$HeartAttack, df_clean$INCOME), margin = 2)
#Bar graph
ggplot(df_clean, aes(x = INCOME, fill = HeartAttack)) +
geom_bar(position = "fill") +
ylab("Proportion") +
xlab("Income Level") +
labs(fill = "Heart Attack Status") +
ggtitle("Proportion of Heart Attack by Income Level") +
scale_fill_manual(values = custom_colors) +
scale_x_discrete(limits = c("<$10k", "$10-15k", "$15-20k", "$20-25k", "$25-35k", "$35-50k", "$50-75k", ">=75k")) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
#Table
prop.table(table(df_clean$HeartAttack, df_clean$SEX), margin = 2)
#Bar graph
ggplot(df_clean, aes(x = SEX, fill = HeartAttack)) +
geom_bar(position = "fill") +
ylab("Proportion") +
xlab("Sex") +
labs(fill = "Heart Attack Status") +
ggtitle("Proportion of Heart Attack by Sex") +
scale_fill_manual(values = custom_colors) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
#Table
prop.table(table(df_clean$HeartAttack, df_clean$RACE), margin = 2)
#Bar graph
ggplot(df_clean, aes(x = RACE, fill = HeartAttack)) +
geom_bar(position = "fill") +
ylab("Proportion") +
xlab("Race") +
labs(fill = "Heart Attack Status") +
ggtitle("Proportion of Heart Attack by Race") +
scale_fill_manual(values = custom_colors) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
#Table
prop.table(table(df_clean$HeartAttack, df_clean$BMI_Cat), margin = 2)
ggplot(df_clean, aes(x = BMI_Cat, fill = HeartAttack)) +
geom_bar(position = "fill") +
ylab("Proportion") +
xlab("BMI Level") +
labs(fill = "Heart Attack Status") +
scale_x_discrete(
limits = c("Normal", "Obese", "Overweight"),
labels = c(
"Normal"      = "Normal Weight (18.5–24.9)",
"Obese"       = "Obese (≥ 30.0)",
"Overweight"  = "Overweight (25.0–29.9)"
),
drop = TRUE
) +
scale_fill_manual(values = custom_colors)
#Table
prop.table(table(df_clean$HeartAttack, df_clean$BMI_Cat), margin = 2)
ggplot(df_clean, aes(x = BMI_Cat, fill = HeartAttack)) +
geom_bar(position = "fill") +
ylab("Proportion") +
xlab("BMI Level") +
labs(fill = "Heart Attack Status") +
scale_x_discrete(
limits = c("Normal", "Overweight", "Obese"),
labels = c(
"Normal"      = "Normal Weight (18.5–24.9)",
"Obese"       = "Obese (≥ 30.0)",
"Overweight"  = "Overweight (25.0–29.9)"
),
drop = TRUE
) +
scale_fill_manual(values = custom_colors)
#Table
prop.table(table(df_clean$HeartAttack, df_clean$BMI_Cat), margin = 2)
#Bar graph
ggplot(df_clean, aes(x = BMI_Cat, fill = HeartAttack)) +
geom_bar(position = "fill") +
ylab("Proportion") +
xlab("BMI Level") +
labs(fill = "Heart Attack Status") +
scale_x_discrete(
limits = c("Normal", "Overweight", "Obese"),
labels = c(
"Normal"      = "Normal Weight (18.5–24.9)",
"Obese"       = "Obese (≥ 30.0)",
"Overweight"  = "Overweight (25.0–29.9)"
),
drop = TRUE
) +
scale_fill_manual(values = custom_colors)
#Table
prop.table(table(df_clean$HeartAttack, df_clean$BMI_Cat), margin = 2)
#Bar graph
ggplot(df_clean, aes(x = BMI_Cat, fill = HeartAttack)) +
geom_bar(position = "fill") +
ylab("Proportion") +
xlab("BMI Level") +
labs(fill = "Heart Attack Status") +
scale_x_discrete(
limits = c("Normal", "Overweight", "Obese"),
labels = c(
"Normal"      = "Normal Weight (18.5–24.9)",
"Obese"       = "Obese (≥ 30.0)",
"Overweight"  = "Overweight (25.0–29.9)"
),
drop = TRUE
) +
scale_fill_manual(values = custom_colors)+
theme(axis.text.x = element_text(angle = 45, hjust = 1)
#Table
prop.table(table(df_clean$HeartAttack, df_clean$BMI_Cat), margin = 2)
#Bar graph
ggplot(df_clean, aes(x = BMI_Cat, fill = HeartAttack)) +
geom_bar(position = "fill") +
ylab("Proportion") +
xlab("BMI Level") +
labs(fill = "Heart Attack Status") +
scale_x_discrete(
limits = c("Normal", "Overweight", "Obese"),
labels = c(
"Normal"      = "Normal Weight (18.5–24.9)",
"Obese"       = "Obese (≥ 30.0)",
"Overweight"  = "Overweight (25.0–29.9)"
),
drop = TRUE
) +
scale_fill_manual(values = custom_colors) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
